<div view-heading
     title="Statistics"
     sub-title="Have a look at some numbers we gathered for your tests">
</div>

<div class="sub-nav" fix-on-scroll="{top:124,class:'fixed'}">
    <div class="container">

        <div ng-show="selectedChartMode === null">

            <div class="pull-left" style="margin-right: 16px">
                <input type="checkbox" selection-checkbox-all items="results">
            </div>

            <div class="btn-group btn-group-xs pull-left" dropdown dropdown-hover>
                <button class="btn btn-primary" ng-class="selectedResults.length > 0 ? '' : 'disabled'">
                    Create Chart
                </button>
                <ul class="dropdown-menu" role="menu" ng-show="selectedResults.length > 0">
                    <li>
                        <a href ng-click="createChartFromFinalResults()">
                            <i class="fa fa-fw fa-bar-chart"></i> Final Results
                        </a>
                    </li>
                    <li>
                        <a href ng-click="createChartFromCompleteResults()">
                            <i class="fa fa-fw fa-area-chart"></i> Complete Results
                        </a>
                    </li>
                </ul>
            </div>

            <div class="btn-group btn-group-xs pull-right" dropdown dropdown-hover>
                <button class="btn btn-default" ng-class="selectedResults.length > 0 ? '' : 'disabled'">
                    <i class="fa fa-fw fa-download"></i> Download as *.csv
                </button>
                <ul class="dropdown-menu" role="menu" ng-show="selectedResults.length > 0">
                    <li>
                        <a href download-learner-results-as-csv results="selectedResults">
                            Selected Final Results
                        </a>
                    </li>
                    <li ng-show="selectedResults.length === 1">
                        <a href download-learner-results-as-csv results="selectedResults">
                            Selected Complete Result
                        </a>
                    </li>
                </ul>
            </div>

        </div>

        <div ng-show="selectedChartMode !== null">

            <div class="pull-left">
                <button class="btn btn-default btn-xs" ng-click="back()">
                    <i class="fa fa-reply fa-fw"></i> Back
                </button>
            </div>

            <div class="pull-right">
                <button class="btn btn-default btn-xs" download-svg ancestor-or-element="#learn-result-chart">
                    <i class="fa fa-download fa-fw"></i> Download as *.svg
                </button>
                <button class="btn btn-default btn-xs" ng-click="fullWidth = !fullWidth" dispatch-resize="20">
                    <i class="fa fa-fw" ng-class="fullWidth ? 'fa-compress' : 'fa-expand'"></i>
                </button>
            </div>

        </div>

    </div>
</div>

<div class="view-body">
    <div class="container" ng-style="fullWidth ? {'width':'100%'} : {}">

        <div class="selectable-list" ng-show="selectedChartMode === null">
            <div ng-repeat="result in results"
                 selection-model
                 selection-model-type="checkbox"
                 selection-model-selected-attribute="_selected"
                 selection-model-mode="multiple"
                 selection-model-selected-items="selectedResults"
                 selection-model-cleanup-strategy="deselect">

                <div selectable-list-item>

                    <strong>Test No
                        <span ng-bind="result.testNo"></span>
                    </strong>,
                    [<span ng-bind="(result.configuration.algorithm|formatAlgorithm)"></span>]

                    <div class="text-muted">
                        Started: <span ng-bind="(result.statistics.startTime | date : 'EEE, dd.MM.yyyy, HH:mm')"></span>
                    </div>

                </div>
            </div>
        </div>

        <div ng-if="selectedChartMode !== null && chartData.data !== null && chartData.options !== null"
             id="learn-result-chart">

            <linechart data="chartData.data" options="chartData.options" mode="" width="" height="500"></linechart>
            <hr>

            <div class="text-center">
                <button class="btn btn-xs"
                        ng-class="selectedChartProperty === chartProperties.MQS ? 'btn-primary':'btn-default'"
                        ng-click="selectChartProperty(chartProperties.MQS)">
                    #MQs
                </button>
                <button class="btn btn-xs"
                        ng-class="selectedChartProperty === chartProperties.EQS ? 'btn-primary':'btn-default'"
                        ng-click="selectChartProperty(chartProperties.EQS)">
                    #EQs
                </button>
                <button class="btn btn-xs"
                        ng-class="selectedChartProperty === chartProperties.SYMBOL_CALLS ? 'btn-primary':'btn-default'"
                        ng-click="selectChartProperty(chartProperties.SYMBOL_CALLS)">
                    #Called Symbols
                </button>
                <button class="btn btn-xs"
                        ng-class="selectedChartProperty === chartProperties.SIGMA ? 'btn-primary':'btn-default'"
                        ng-click="selectChartProperty(chartProperties.SIGMA)">
                    |Sigma|
                </button>
                <button class="btn btn-xs"
                        ng-class="selectedChartProperty === chartProperties.DURATION ? 'btn-primary':'btn-default'"
                        ng-click="selectChartProperty(chartProperties.DURATION)">
                    Duration
                </button>
            </div>
            <hr>

            <div ng-repeat="result in selectedResults | orderBy:'-testNo'">
                <strong>Test <span ng-bind="result.testNo"></span></strong>:
                [<span ng-bind="(result.configuration.algorithm|formatAlgorithm)"></span>],
                {{result.configuration.eqOracle}}
            </div>

        </div>

        <div class="alert alert-info" ng-show="results.length === 0">
            You have not run any tests yet.
        </div>

    </div>
</div>