<div ng-controller="LearnResultsStatisticsController as vm">
    <view-header title="Statistics"></view-header>

    <action-bar>
        <div ng-if="vm.results.length > 0">
            <div ng-if="vm.selectedChartMode === null">

                <checkbox-multiple model="vm.results" class="pull-left"></checkbox-multiple>

                <div class="btn-group btn-group-sm pull-left" dropdown dropdown-hover>
                    <button class="btn btn-primary btn-dropdown"
                            ng-class="{'disabled': vm.selectedResults.length > 0}">
                        Create Chart
                    </button>
                    <ul class="dropdown-menu" role="menu" ng-show="vm.selectedResults.length > 0">
                        <li>
                            <a href="" ng-click="vm.createChartFromFinalResults()">
                                <i class="fa fa-fw fa-bar-chart"></i> Final Results
                            </a>
                        </li>
                        <li>
                            <a href="" ng-click="vm.createChartFromCompleteResults()">
                                <i class="fa fa-fw fa-area-chart"></i> Complete Results
                            </a>
                        </li>
                    </ul>
                </div>

                <div class="btn-group btn-group-sm pull-right" dropdown dropdown-hover>
                    <button class="btn btn-default btn-dropdown"
                            ng-class="{'disabled': vm.selectedResults.length > 0}">
                        <i class="fa fa-fw fa-download"></i> Download as *.csv
                    </button>
                    <ul class="dropdown-menu" role="menu" ng-if="vm.selectedResults.length > 0">
                        <li>
                            <a href="" download-learner-results-as-csv results="vm.selectedResults">
                                Selected Final Results
                            </a>
                        </li>
                        <li ng-show="selectedResults.length === 1">
                            <a href="" download-learner-results-as-csv results="vm.selectedResults" complete>
                                Selected Complete Result
                            </a>
                        </li>
                    </ul>
                </div>

            </div>

            <div ng-if="vm.selectedChartMode !== null">

                <div class="pull-left">
                    <button class="btn btn-default btn-sm" ng-click="vm.back()">
                        <i class="fa fa-reply fa-fw"></i> Back
                    </button>
                </div>

                <div class="pull-right">
                    <button class="btn btn-default btn-sm" download-svg="#learn-result-chart" adjust-size="false">
                        <i class="fa fa-download fa-fw"></i> Download as *.svg
                    </button>
                </div>

            </div>
        </div>
    </action-bar>

    <div class="view-body has-sub-nav">
        <div class="alx-container-fluid">

            <div class="selectable-list" ng-show="vm.selectedChartMode === null">

                <learn-result-list>
                    <learn-result-list-item ng-repeat="result in vm.results | orderBy:'-testNo':false" result="result"
                                            selection-model selection-model-selected-items="vm.selectedResults">

                    </learn-result-list-item>
                </learn-result-list>
            </div>

            <div ng-if="vm.selectedChartMode !== null && vm.chartData.data !== null && vm.chartData.options !== null"
                 id="learn-result-chart">

                <linechart data="vm.chartData.data" options="vm.chartData.options" mode="" width="" height="500"></linechart>
                <hr>

                <div class="text-center">
                    <button class="btn btn-xs"
                            ng-class="vm.selectedChartProperty === vm.chartProperties.MQS ? 'btn-primary':'btn-default'"
                            ng-click="vm.selectChartProperty(vm.chartProperties.MQS)">
                        #MQs
                    </button>
                    <button class="btn btn-xs"
                            ng-class="vm.selectedChartProperty === vm.chartProperties.EQS ? 'btn-primary':'btn-default'"
                            ng-click="vm.selectChartProperty(vm.chartProperties.EQS)">
                        #EQs
                    </button>
                    <button class="btn btn-xs"
                            ng-class="vm.selectedChartProperty === vm.chartProperties.SYMBOL_CALLS ? 'btn-primary':'btn-default'"
                            ng-click="vm.selectChartProperty(vm.chartProperties.SYMBOL_CALLS)">
                        #Called Symbols
                    </button>
                    <button class="btn btn-xs"
                            ng-class="vm.selectedChartProperty === vm.chartProperties.SIGMA ? 'btn-primary':'btn-default'"
                            ng-click="vm.selectChartProperty(vm.chartProperties.SIGMA)">
                        |Sigma|
                    </button>
                    <button class="btn btn-xs"
                            ng-class="vm.selectedChartProperty === vm.chartProperties.DURATION ? 'btn-primary':'btn-default'"
                            ng-click="vm.selectChartProperty(vm.chartProperties.DURATION)">
                        Duration
                    </button>
                </div>
                <hr>

                <table class="table table-condensed">
                    <thead>
                    <tr>
                        <th width="0">Test No</th>
                        <th>Algorithm</th>
                        <th>Eq-oracle</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr ng-repeat="result in vm.selectedResults | orderBy:'-testNo'">
                        <td ng-bind="result.testNo"></td>
                        <td ng-bind="(result.configuration.algorithm|formatAlgorithm)"></td>
                        <td>{{result.configuration.eqOracle}}</td>
                    </tr>
                    </tbody>
                </table>

            </div>

            <div class="alert alert-info" ng-if="vm.results.length === 0">
                You have not run any tests yet.
            </div>

        </div>
    </div>
</div>