<div class="view">
  <view-header [title]="'Environments'"></view-header>

  <action-bar>
    <div class="d-flex flex-row align-items-center">
      <div class="w-100 ml-3">

        <div class="btn-group btn-group-sm" uib-dropdown>
          <button class="btn btn-primary btn-dropdown" uib-dropdown-toggle>
            Create
          </button>
          <div uib-dropdown-menu class="dropdown-menu" role="menu">
            <div class="dropdown-item cursor-pointer" ng-click="vm.createEnvironment()">Environment</div>
            <div class="dropdown-item cursor-pointer" ng-click="vm.createUrl()">URL</div>
            <div class="dropdown-item cursor-pointer" ng-click="vm.createVariable()">Variable</div>
          </div>
        </div>

      </div>
    </div>
  </action-bar>

  <div class="view-body">
    <div class="container-fluid">

      <div class="card card-environment mb-4" ng-repeat="env in vm.environments track by env.id">
        <div class="card-header d-flex flex-row align-items-center">
          <div class="w-100 mr-3">
            <strong>{{env.name}}</strong>
          </div>
          <div class="flex-shrink-0">
            <div class="btn-group btn-group-sm actions">
              <button class="btn btn-outline-secondary" ng-click="vm.editEnvironment(env)" uib-tooltip="Edit" tooltip-placement="top">
                <i class="fas fa-fw fa-edit"></i>
              </button>
              <button class="btn btn-outline-secondary" ng-click="vm.deleteEnvironment(env)" uib-tooltip="Delete" tooltip-placement="top">
                <i class="fas fa-fw fa-trash"></i>
              </button>
            </div>
          </div>
          <div class="ml-3">
            <span
                    class="badge cursor-pointer"
                    ng-class="{'badge-secondary': !env.default, 'badge-primary': env.default}"
                    ng-click="vm.makeEnvironmentDefault(env)"
            >
              Default
            </span>
          </div>
        </div>
        <div class="card-body">

          <uib-tabset>
            <uib-tab heading="URLs">
              <p></p>

              <table class="table mb-0">
                <thead class="bg-light">
                <tr>
                  <th width="1">Name</th>
                  <th>URL</th>
                  <th width="1">&nbsp;</th>
                  <th width="1">&nbsp;</th>
                </tr>
                </thead>
                <tbody>
                <tr ng-repeat="url in env.urls">
                  <td>
                    <span class="badge badge-secondary mr-3">{{url.name}}</span>
                  </td>
                  <td>
                    {{url.url}}
                  </td>
                  <td>
                    <div class="btn-group btn-group-sm actions">
                      <button class="btn btn-outline-secondary" ng-click="vm.editUrl(env, url)" uib-tooltip="Edit" tooltip-placement="top">
                        <i class="fas fa-fw fa-edit"></i>
                      </button>
                      <button class="btn btn-outline-secondary" ng-click="vm.deleteUrl(env, url)" uib-tooltip="Delete" tooltip-placement="top">
                        <i class="fas fa-fw fa-trash"></i>
                      </button>
                    </div>
                  </td>
                  <td>
                      <span
                              class="badge cursor-pointer"
                              ng-class="{'badge-secondary': !url.default, 'badge-primary': url.default}"
                              ng-click="vm.makeUrlDefault(env, url)"
                      >
                         Default
                      </span>
                  </td>
                </tr>
                </tbody>
              </table>

            </uib-tab>
            <uib-tab heading="Variables">
              <p></p>

              <div class="alert alert-info mb-0" ng-if="env.variables.length === 0">
                No environment variables have been defined yet.
              </div>

              <table class="table mb-0" ng-if="env.variables.length > 0">
                <thead class="bg-light">
                <tr>
                  <th width="1">Variable</th>
                  <th>Value</th>
                  <th width="1">&nbsp;</th>
                </tr>
                </thead>
                <tbody>
                <tr ng-repeat="v in env.variables">
                  <td>
                    <strong style="white-space: nowrap">{{v.name}}</strong>
                  </td>
                  <td>{{v.value}}</td>
                  <td>
                    <div class="btn-group btn-group-sm actions">
                      <button class="btn btn-outline-secondary" ng-click="vm.editVariable(env, v)" uib-tooltip="Edit" tooltip-placement="top">
                        <i class="fas fa-fw fa-edit"></i>
                      </button>
                      <button class="btn btn-outline-secondary" ng-click="vm.deleteVariable(env, v)" uib-tooltip="Delete" tooltip-placement="top">
                        <i class="fas fa-fw fa-trash"></i>
                      </button>
                    </div>
                  </td>
                </tr>
                </tbody>
              </table>

            </uib-tab>
          </uib-tabset>

        </div>
      </div>

    </div>
  </div>

</div>
