<div class="view view-test-case">
  <view-header [title]="'Test Management'"></view-header>
  <action-bar>
    <button class="btn btn-sm btn-success mr-2" [disabled]="active" (click)="save()">
      <i class="fas fa-fw fa-save"></i> Save
    </button>
    <div class="btn-group btn-group-sm float-right mr-0">
      <button class="btn btn-primary" (click)="execute()" [disabled]="active">
        Execute
      </button>
      <button class="btn btn-primary" (click)="openTestConfigModal()" [disabled]="active">
        <i class="fas fa-fm fa-cog"></i>
      </button>
    </div>
  </action-bar>
  <div class="view-body">
    <div class="container-fluid">

      <div *ngIf="result">
        <div class="alert alert-danger" *ngIf="!result.passed">
          <i class="fas fa-fw fa-times float-right" (click)="result = null"></i>
          <i class="fas fa-fw fa-exclamation-circle"></i> <strong>The test case failed.</strong>
          <a *ngIf="testConfig.createReport"
             href="{{'#!/projects/' + project.id + '/tests/reports/' + report.id}}">(Show report)</a>
        </div>
        <div class="alert alert-success" *ngIf="result.passed">
          <i class="fas fa-fw fa-times float-right" (click)="result = null"></i>
          <i class="fas fa-fw fa-check"></i> <strong>The test case passed.</strong>
          <a *ngIf="testConfig.createReport"
             [href]="'#!/projects/' + project.id + '/tests/reports/' + report.id">(Show report)</a>
        </div>
        <hr>
      </div>

      <div *ngIf="active">
        <div class="alert alert-info">
          <i class="fas fa-fw fa-circle-notch fa-spin"></i> The test is being executed.
        </div>
        <hr>
      </div>

      <div class="d-flex align-items-center">
        <div class="mr-1">
          <a
            class="btn btn-sm btn-default"
            [href]="'#!/projects/' + testCase.project + '/tests/' + testCase.parent"
          >
            <i class="fas fa-fw fa-level-up-alt"></i>
          </a>
        </div>
        <h4 class="w-100 m-0">
          <strong>
            <i class="fas fa-fw fa-file"></i> {{testCase.name}}
          </strong>
        </h4>
        <div>
          <div class="btn-group btn-group-sm" ngbDropdown>
            <button type="button" class="btn btn-default" ngbDropdownToggle>
              <i class="fas fa-cogs"></i>
            </button>
            <div ngbDropdownMenu class="dropdown-menu dropdown-menu-right" role="menu">
              <div ngbDropdownItem (click)="options.showSymbolOutputs = !options.showSymbolOutputs">
                <i class="fas fa-fw" [ngClass]="{'fa-check': options.showSymbolOutputs}"></i> Show symbol outputs
              </div>
            </div>
          </div>
        </div>
      </div>

      <hr>
      <div class="row">
        <div class="col-md-3 col-sm-5">

          <div class="card">
            <div class="card-header">
              <strong>Symbols</strong>
            </div>
            <div class="card-body">
              <div style="height: 31px; position: relative; z-index: 10" class="mb-2">
                <symbol-search-form [groups]="groups" (selected)="addSymbolStep($event)"></symbol-search-form>
              </div>

              <simple-symbol-group-tree
                [groups]="groups"
                (symbolSelected)="addSymbolStep($event)"
              >
              </simple-symbol-group-tree>
            </div>
          </div>

        </div>
        <div class="col-md-9 col-sm-7">

          <test-case-table
            *ngIf="testCase != null"
            [testCase]="testCase"
            [symbolMap]="symbolMap"
            [options]="options"
            [result]="result"
          >
          </test-case-table>

        </div>
      </div>
    </div>
  </div>
</div>
